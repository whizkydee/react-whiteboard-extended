(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(t,e,a){t.exports=a(17)},17:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a.n(n),s=a(10),o=a.n(s),r=a(1),h=a(2),c=a(4),u=a(3),l=a(5),p=new(function(){function t(){Object(r.a)(this,t);Object.assign(this,{START_PATH:"startPath",MOVE_PATH:"movePath",END_PATH:"endPath",UNDO:"undo",REDO:"redo",TOOL_CHANGE:"toolChange",COLOR_CHANGE:"cororChange",PICK_VERSION:"pickVersion",MOVE:"move"}),this.listeners={}}return Object(h.a)(t,[{key:"on",value:function(t,e){var a=this.listeners[t]||[];-1===a.indexOf(e)&&a.push(e),this.listeners[t]=a}},{key:"emit",value:function(t){var e=arguments;(this.listeners[t]||[]).forEach(function(t){t.apply({},e)})}}]),t}()),d=a(6),y=a(11),f=a.n(y),m="Pointer",b="Pen",v="Line",k="Elipse",O="Rect",x="Eraser",j=new(function(){function t(){Object(r.a)(this,t),this.id="toolStore",p.on(p.TOOL_CHANGE,this.toolChange.bind(this)),p.on(p.COLOR_CHANGE,this.colorChange.bind(this)),this.tool=b,this.color="black"}return Object(h.a)(t,[{key:"subscribe",value:function(t){p.on(this.id,t)}},{key:"emitChanges",value:function(){p.emit(this.id)}},{key:"toolChange",value:function(t,e){this.tool=e,this.emitChanges()}},{key:"colorChange",value:function(t,e){this.color=e,this.emitChanges()}}]),t}()),C=function(t){function e(){return Object(r.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(h.a)(e,[{key:"prepareData",value:function(){return["M ".concat(this.props.path[0].x," ").concat(this.props.path[0].y),"L ".concat(this.props.path[this.props.path.length-1].x," ").concat(this.props.path[this.props.path.length-1].y)].join(" ")}},{key:"render",value:function(){var t=this.prepareData();return i.a.createElement("path",{d:t,fill:"none",strokeWidth:3,stroke:this.props.color})}}]),e}(i.a.Component),g=a(8),E=function(t,e,a,n){var i=function(t,e){var a=e[0]-t[0],n=e[1]-t[1];return{length:Math.sqrt(Math.pow(a,2)+Math.pow(n,2)),angle:Math.atan2(n,a)}}(e||t,a||t),s=i.angle+(n?Math.PI:0),o=.2*i.length;return[t[0]+Math.cos(s)*o,t[1]+Math.sin(s)*o]},M=function(t,e,a){var n=E(a[e-1],a[e-2],t),i=Object(g.a)(n,2),s=i[0],o=i[1],r=E(t,a[e-1],a[e+1],!0),h=Object(g.a)(r,2),c=h[0],u=h[1];return"C ".concat(s,", ").concat(o," ").concat(c,", ").concat(u," ").concat(t[0],", ").concat(t[1])};var T=function(t){function e(){return Object(r.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(h.a)(e,[{key:"prepareData",value:function(){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return t.reduce(function(t,a,n,i){return 0===n?"M ".concat(a[0],", ").concat(a[1]):"".concat(t," ").concat(e(a,n,i))},"")}(this.props.path.map(function(t){return[t.x,t.y]}))}},{key:"render",value:function(){var t=this.prepareData();return i.a.createElement("path",{d:t,fill:"none",strokeWidth:3,stroke:this.props.color})}}]),e}(i.a.Component),w=function(t){function e(){return Object(r.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(h.a)(e,[{key:"prepareData",value:function(){return{x:this.props.path[0].x,y:this.props.path[0].y,width:Math.abs(this.props.path[this.props.path.length-1].x-this.props.path[0].x),height:Math.abs(this.props.path[this.props.path.length-1].y-this.props.path[0].y)}}},{key:"render",value:function(){var t=this.prepareData();return i.a.createElement("rect",{x:t.x,y:t.y,fill:"none",strokeWidth:3,width:t.width,height:t.height,stroke:this.props.color})}}]),e}(i.a.Component),P=function(t){function e(){return Object(r.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(h.a)(e,[{key:"prepareData",value:function(){return{cx:this.props.path[0].x,cy:this.props.path[0].y,r:Math.abs(this.props.path[this.props.path.length-1].x-this.props.path[0].x)}}},{key:"render",value:function(){var t=this.prepareData();return i.a.createElement("circle",{fill:"none",r:t.r,cx:t.cx,cy:t.cy,strokeWidth:3,stroke:this.props.color})}}]),e}(i.a.Component),D=function(t){function e(){return Object(r.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(h.a)(e,[{key:"prepareData",value:function(){var t=["M ".concat(this.props.path[0].x," ").concat(this.props.path[0].y)],e=this.props.path.map(function(t){var e=t.x,a=t.y;return"L ".concat(e," ").concat(a)});return t.concat(e).join(" ")}},{key:"render",value:function(){var t=this.prepareData();return i.a.createElement("path",{d:t,fill:"none",strokeWidth:20,stroke:"#ffffff"})}}]),e}(i.a.Component),I=a(7);var _={};_[v]=C,_[O]=w,_[k]=P,_[b]=T,_[x]=D;var R=new(function(){function t(){var e=this;Object(r.a)(this,t),this.id="whiteBoardStore",p.on(p.START_PATH,this.startPath.bind(this)),p.on(p.MOVE_PATH,this.movePath.bind(this)),p.on(p.END_PATH,this.endPath.bind(this)),p.on(p.UNDO,this.undo.bind(this)),p.on(p.REDO,this.redo.bind(this)),p.on(p.PICK_VERSION,this.pickVersion.bind(this)),p.on(p.MOVE,this.move.bind(this)),this.data={shapes:f.a.List.of(),selected:[],mouseTracker:null},this.history=[this.data.shapes],this.historyIndex=-1,this.tool=T,this.color="black",j.subscribe(function(){var t=j.tool;e.toolType=t,e.tool=_[t]||null,e.color=j.color})}return Object(h.a)(t,[{key:"subscribe",value:function(t){p.on(this.id,t)}},{key:"emitChanges",value:function(){p.emit(this.id)}},{key:"startPath",value:function(t,e){this.data.mouseTracker={class:this.tool,type:this.toolType,path:[e],color:this.color},this.toolType===m&&this.selectShape(e),this.emitChanges()}},{key:"movePath",value:function(t,e){this.data.mouseTracker&&(this.data.mouseTracker.path.push(e),this.emitChanges())}},{key:"endPath",value:function(t,e){this.data.mouseTracker&&(this.data.mouseTracker.path.push(e),this.toolType===m?this.addVersion():this.data.mouseTracker.class&&this.addShapeToCanvas(this.data.mouseTracker),this.data.mouseTracker=null,this.emitChanges())}},{key:"addShapeToCanvas",value:function(t){this.data.shapes=this.data.shapes.push(t),this.data.mouseTracker=null,this.addVersion()}},{key:"selectShape",value:function(t){this.data.shapes=this.data.shapes.map(function(e){return a=t,n=function(t){var e=t.path.length-1;if(t.type===k){var a=Math.abs(t.path[0].x-t.path[e].x),n=Math.abs(t.path[0].y-t.path[e].y);return{x:Math.min(t.path[0].x,t.path[e].x)-a,y:Math.min(t.path[0].y,t.path[e].y)-n,width:2*a,height:2*n}}if(t.type===b){var i=Math.min.apply(Math,Object(I.a)(t.path.map(function(t){return t.x}))),s=Math.max.apply(Math,Object(I.a)(t.path.map(function(t){return t.x}))),o=Math.min.apply(Math,Object(I.a)(t.path.map(function(t){return t.y})));return{x:i,y:o,width:s-i,height:Math.max.apply(Math,Object(I.a)(t.path.map(function(t){return t.y})))-o}}return t.type===x?{}:{x:Math.min(t.path[0].x,t.path[e].x),y:Math.min(t.path[0].y,t.path[e].y),width:Math.abs(t.path[0].x-t.path[e].x),height:Math.abs(t.path[0].y-t.path[e].y)}}(e),a.x>=n.x&&a.x<=n.x+n.width&&a.y>=n.y&&a.y<=n.y+n.height?Object(d.a)({},e,{selected:!0}):Object(d.a)({},e,{selected:!1});var a,n})}},{key:"addVersion",value:function(){this._catHistory(),this.history.push(this.data.shapes),this.historyIndex=-1}},{key:"undo",value:function(){this.history.length>0&&(-1===this.historyIndex&&(this.historyIndex=this.history.length-1),this.pickVersion(null,this.historyIndex-1))}},{key:"redo",value:function(){this.history.length>0&&this.pickVersion(null,this.historyIndex+1)}},{key:"_catHistory",value:function(){this.historyIndex>=0&&this.history.splice(this.historyIndex+1,this.history.length-this.historyIndex-1)}},{key:"pickVersion",value:function(t,e){if(this.history&&this.history[e]){this.historyIndex=e;var a=this.history[e];this.data.shapes=a,this.emitChanges()}}},{key:"move",value:function(t,e){var a=e.shape,n=e.move;this.data.shapes=this.data.shapes.map(function(t){return a===t?Object(d.a)({},t,{path:t.path.map(function(t){var e=t.x,a=t.y;return{x:e+n.x,y:a+n.y}})}):t})}}]),t}()),A=function(t){function e(){var t;return Object(r.a)(this,e),(t=Object(c.a)(this,Object(u.a)(e).call(this))).preventContextMenu=function(t){return t.preventDefault(),!1},R.subscribe(function(){t.setState({data:R.data})}),t.state={data:R.data},t.pressed=!1,t}return Object(l.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.mouseDown.bind(this)),document.addEventListener("mousemove",this.mouseMove.bind(this)),document.addEventListener("mouseup",this.mouseUp.bind(this)),document.addEventListener("keydown",this.keyDown.bind(this)),window.addEventListener("resize",this.onResize.bind(this)),this.onResize(),this.setState({data:R.data})}},{key:"onResize",value:function(){this.rect=this._svg.getBoundingClientRect()}},{key:"mousePos",value:function(t){return{x:2*Math.round(t.clientX/2)-this.rect.left,y:2*Math.round(t.clientY/2)-this.rect.top}}},{key:"_insideRect",value:function(t,e){return e.x>t.left&&e.x<t.right&&e.y>t.top&&e.y<t.bottom}},{key:"mouseDown",value:function(t){this._insideRect(this.rect,{x:t.clientX,y:t.clientY})&&(this.pressed=!0,p.emit(p.START_PATH,this.mousePos(t)))}},{key:"mouseMove",value:function(t){this.pressed&&p.emit(p.MOVE_PATH,this.mousePos(t))}},{key:"mouseUp",value:function(t){this.pressed=!1,p.emit(p.END_PATH,this.mousePos(t))}},{key:"keyDown",value:function(t){if(t.ctrlKey)switch(t.keyCode){case 90:p.emit(p.UNDO);break;case 89:p.emit(p.REDO)}}},{key:"onMove",value:function(t){return function(e){p.emit(p.MOVE,{shape:t,move:e})}}},{key:"render",value:function(){var t=this,e=this.state.data,a=e.shapes.map(function(t,e){return i.a.createElement(t.class,{key:e,path:t.path,color:t.color})}),n=null;return e.mouseTracker&&e.mouseTracker.class&&(n=i.a.createElement(e.mouseTracker.class,{color:e.mouseTracker.color,path:e.mouseTracker.path})),i.a.createElement("svg",{id:"whiteBoard",width:this.props.width,height:this.props.height,ref:function(e){return t._svg=e},onContextMenu:this.preventContextMenu},a,n)}}]),e}(i.a.Component),H=function(t){function e(){var t;return Object(r.a)(this,e),(t=Object(c.a)(this,Object(u.a)(e).call(this))).state={colors:["red","orange","yellow","green","blue","indigo","violet","black"],selectedColorIndex:7},j.subscribe(function(){var e=j.color,a=t.state.colors.indexOf(e);t.setState({selectedColorIndex:a})}),t}return Object(l.a)(e,t),Object(h.a)(e,[{key:"handleClick",value:function(t){return function(){p.emit(p.COLOR_CHANGE,this.state.colors[t])}}},{key:"render",value:function(){var t=this,e=this.state.colors.map(function(e,a){var n={display:"flex",backgroundColor:e,width:20,height:20,margin:5},s={display:"flex",border:t.state.selectedColorIndex===a?"1px solid":"",margin:1};return i.a.createElement("div",{key:a,style:s},i.a.createElement("div",{style:n,onClick:t.handleClick(a).bind(t)}))});return i.a.createElement("div",{id:"colors"}," ",e," ")}}]),e}(i.a.Component),N=function(t){function e(){var t;return Object(r.a)(this,e),(t=Object(c.a)(this,Object(u.a)(e).call(this))).state={tools:[{id:m,label:"fa-mouse-pointer",type:"cursor"},{id:v,label:"fa-minus",type:"line"},{id:O,label:"fa-square-o",type:"rect"},{id:k,label:"fa-circle-thin",type:"circle"},{id:b,label:"fa-pencil",type:"pen",selected:!0},{id:x,label:"fa-eraser",type:"eraser"}]},j.subscribe(function(){var e=t.state.tools.map(function(t){return Object(d.a)({},t,{selected:j.tool===t.id})});t.setState({tools:e})}),t}return Object(l.a)(e,t),Object(h.a)(e,[{key:"handleClick",value:function(t){return function(){p.emit(p.TOOL_CHANGE,this.state.tools[t].id)}}},{key:"render",value:function(){var t=this,e=this.state.tools.map(function(e,a){return i.a.createElement("div",{key:a,onClick:t.handleClick(a).bind(t),className:e.selected?"selected":""},i.a.createElement("i",{className:e.label+" fa"}))});return i.a.createElement("div",{id:"tools"},e,i.a.createElement(H,null))}}]),e}(i.a.Component),S=function(t){function e(){var t;return Object(r.a)(this,e),t=Object(c.a)(this,Object(u.a)(e).call(this)),R.subscribe(function(){t.setState({history:R.history,selectedIndex:R.historyIndex})}),t.state={history:[],selectedIndex:-1},t}return Object(l.a)(e,t),Object(h.a)(e,[{key:"handleClick",value:function(t){return function(){p.emit(p.PICK_VERSION,t)}}},{key:"render",value:function(){var t=this,e=this.state.history.map(function(e,a){return i.a.createElement("span",{key:a,onClick:t.handleClick(a).bind(t),className:t.state.selectedIndex===a?"selected":""})});return i.a.createElement("div",{id:"history"}," History: ",e," ")}}]),e}(i.a.Component);o.a.render(i.a.createElement("div",{id:"main"},i.a.createElement("div",{id:"container"},i.a.createElement(N,null),i.a.createElement(A,null)),i.a.createElement(S,null)),document.getElementById("app"))}},[[12,2,1]]]);
//# sourceMappingURL=main.df869e76.chunk.js.map