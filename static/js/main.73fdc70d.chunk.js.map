{"version":3,"sources":["eventBus.js","toolStore.js","components/shapes/line.js","smooth-path.js","components/shapes/pen.js","components/shapes/rect.js","components/shapes/circle.js","components/eraser.js","utils.js","store.js","components/selection.js","components/whiteBoard.js","components/colorPicker.js","components/tools.js","components/history.js","index.js"],"names":["eventBus","EventBus","Object","classCallCheck","this","assign","START_PATH","MOVE_PATH","END_PATH","UNDO","REDO","TOOL_CHANGE","COLOR_CHANGE","PICK_VERSION","MOVE","listeners","event","cb","callbacks","indexOf","push","_arguments","arguments","forEach","callback","apply","POINTER","PEN","LINE","CIRCLE","RECT","ERASER","toolStore","ToolStore","id","on","toolChange","bind","colorChange","tool","color","emit","emitChanges","Line","concat","props","path","x","y","length","join","d","prepareData","react_default","a","createElement","fill","strokeWidth","stroke","React","Component","controlPoint","current","previous","next","reverse","o","pointA","pointB","lengthX","lengthY","Math","sqrt","pow","angle","atan2","line","PI","cos","sin","toCubicBeizer","point","i","_controlPoint","_controlPoint2","slicedToArray","cpsX","cpsY","_controlPoint3","_controlPoint4","cpeX","cpeY","Pen","points","undefined","reduce","acc","smoothPath","map","_ref","Rect","width","abs","height","rect","Circle","cx","cy","r","circle","Eraser","collector","getShapeRect","shape","end","type","halfWidth","halfHeight","min","minX","toConsumableArray","p","maxX","max","minY","mapTools","store","Store","_this","startPath","movePath","endPath","undo","redo","pickVersion","move","data","shapes","Immutable","List","of","selected","mouseTracker","history","historyIndex","subscribe","toolType","position","class","selectShape","addVersion","addShapeToCanvas","objectSpread","_catHistory","splice","index","s","_ref2","Selection","possibleConstructorReturn","getPrototypeOf","call","startMove","assertThisInitialized","endMove","onMove","startPoint","e","preventDefault","clientX","clientY","onMouseUp","onMouseMove","onMouseDown","WhiteBoard","preventContextMenu","setState","state","pressed","document","addEventListener","mouseDown","mouseMove","mouseUp","keyDown","window","onResize","_svg","getBoundingClientRect","round","left","top","right","bottom","_insideRect","mousePos","keyCode","_this2","selection","selection_Selection","key","ref","canvas","onContextMenu","ColorPicker","colors","selectedColorIndex","selectedColor","style","display","backgroundColor","margin","borderStyle","border","onClick","handleClick","Tools","tools","label","className","colorPicker_ColorPicker","History","selectedIndex","versions","version","ReactDOM","render","tools_Tools","whiteBoard_WhiteBoard","history_History","getElementById"],"mappings":"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","file":"static/js/main.73fdc70d.chunk.js","sourcesContent":["class EventBus {\n  constructor() {\n    let events = {\n      START_PATH: 'startPath',\n      MOVE_PATH: 'movePath',\n      END_PATH: 'endPath',\n      UNDO: 'undo',\n      REDO: 'redo',\n      TOOL_CHANGE: 'toolChange',\n      COLOR_CHANGE: 'cororChange',\n      PICK_VERSION: 'pickVersion',\n      MOVE: 'move'\n    };\n    Object.assign(this, events);\n    this.listeners = {};\n  }\n\n  on(event, cb) {\n    let callbacks = this.listeners[event] || [];\n    if (callbacks.indexOf(cb) === -1) callbacks.push(cb);\n    this.listeners[event] = callbacks;\n  }\n\n  emit(event) {\n    // console.log(arguments)\n    let callbacks = this.listeners[event] || [];\n    callbacks.forEach(callback => {\n      callback.apply({}, arguments);\n    });\n  }\n}\n\nexport default new EventBus();\n","import EventBus from './eventBus';\n\nexport const POINTER = 'Pointer';\nexport const PEN = 'Pen';\nexport const LINE = 'Line';\nexport const CIRCLE = 'Elipse';\nexport const RECT = 'Rect';\nexport const ERASER = 'Eraser';\n\nclass ToolStore {\n  constructor() {\n    this.id = 'toolStore';\n    EventBus.on(EventBus.TOOL_CHANGE, this.toolChange.bind(this));\n    EventBus.on(EventBus.COLOR_CHANGE, this.colorChange.bind(this));\n    this.tool = PEN;\n    this.color = 'black';\n  }\n  subscribe(cb) {\n    EventBus.on(this.id, cb);\n  }\n  emitChanges() {\n    EventBus.emit(this.id);\n  }\n  toolChange(event, tool) {\n    this.tool = tool;\n    this.emitChanges();\n  }\n  colorChange(event, color) {\n    this.color = color;\n    this.emitChanges();\n  }\n}\n\nexport default new ToolStore();\n","import React from 'react';\n\nexport default class Line extends React.Component {\n  prepareData() {\n    let d = [\n      `M ${this.props.path[0].x} ${this.props.path[0].y}`,\n      `L ${this.props.path[this.props.path.length - 1].x} ${\n        this.props.path[this.props.path.length - 1].y\n      }`\n    ];\n\n    return d.join(' ');\n  }\n\n  render() {\n    let d = this.prepareData();\n    return <path d={d} fill=\"none\" strokeWidth={3} stroke={this.props.color} />;\n  }\n}\n","const line = (pointA, pointB) => {\n  const lengthX = pointB[0] - pointA[0];\n  const lengthY = pointB[1] - pointA[1];\n  return {\n    length: Math.sqrt(Math.pow(lengthX, 2) + Math.pow(lengthY, 2)),\n    angle: Math.atan2(lengthY, lengthX)\n  };\n};\n\nconst controlPoint = (current, previous, next, reverse) => {\n  const p = previous || current;\n  const n = next || current;\n  const smoothing = 0.2;\n  const o = line(p, n);\n  const angle = o.angle + (reverse ? Math.PI : 0);\n  const length = o.length * smoothing;\n  const x = current[0] + Math.cos(angle) * length;\n  const y = current[1] + Math.sin(angle) * length;\n  return [x, y];\n};\n\nconst toCubicBeizer = (point, i, a) => {\n  const [cpsX, cpsY] = controlPoint(a[i - 1], a[i - 2], point);\n  const [cpeX, cpeY] = controlPoint(point, a[i - 1], a[i + 1], true);\n  return `C ${cpsX}, ${cpsY} ${cpeX}, ${cpeY} ${point[0]}, ${point[1]}`;\n};\n\nexport default function smoothPath(points, callback = toCubicBeizer) {\n  // build the 'd' attribute by looping over the points\n  return points.reduce(\n    (acc, point, i, a) =>\n      i === 0\n        ? // if first point\n          `M ${point[0]}, ${point[1]}`\n        : // else\n          `${acc} ${callback(point, i, a)}`,\n    ''\n  );\n};\n","import React from 'react';\nimport smoothPath from '../../smooth-path';\n\nexport default class Pen extends React.Component {\n  prepareData() {\n    const collector = smoothPath(this.props.path.map(({ x, y }) => [x, y]));\n    return collector;\n  }\n\n  render() {\n    let d = this.prepareData();\n    return <path d={d} fill=\"none\" strokeWidth={3} stroke={this.props.color} />;\n  }\n}\n","import React from 'react';\n\nexport default class Rect extends React.Component {\n  prepareData() {\n    let rect = {\n      x: this.props.path[0].x,\n      y: this.props.path[0].y,\n      width: Math.abs(\n        this.props.path[this.props.path.length - 1].x - this.props.path[0].x\n      ),\n      height: Math.abs(\n        this.props.path[this.props.path.length - 1].y - this.props.path[0].y\n      )\n    };\n    return rect;\n  }\n\n  render() {\n    let rect = this.prepareData();\n    return (\n      <rect\n        x={rect.x}\n        y={rect.y}\n        fill=\"none\"\n        strokeWidth={3}\n        width={rect.width}\n        height={rect.height}\n        stroke={this.props.color}\n      />\n    );\n  }\n}\n","import React from 'react';\n\nexport default class Circle extends React.Component {\n  prepareData() {\n    let circle = {\n      cx: this.props.path[0].x,\n      cy: this.props.path[0].y,\n      r: Math.abs(\n        this.props.path[this.props.path.length - 1].x - this.props.path[0].x\n      )\n    };\n    return circle;\n  }\n\n  render() {\n    let circle = this.prepareData();\n    return (\n      <circle\n        fill=\"none\"\n        r={circle.r}\n        cx={circle.cx}\n        cy={circle.cy}\n        strokeWidth={3}\n        stroke={this.props.color}\n      />\n    );\n  }\n}\n","import React from 'react';\n\nexport default class Eraser extends React.Component {\n  prepareData() {\n    let d = [`M ${this.props.path[0].x} ${this.props.path[0].y}`];\n    let collector = this.props.path.map(({ x, y }) => `L ${x} ${y}`);\n    return d.concat(collector).join(' ');\n  }\n\n  render() {\n    let d = this.prepareData();\n    return <path d={d} fill=\"none\" strokeWidth={20} stroke=\"#ffffff\" />;\n  }\n}\n","import { CIRCLE, PEN } from './toolStore';\n\nexport function pointInsideRect(point, rect) {\n  return (\n    point.x >= rect.x &&\n    point.x <= rect.x + rect.width &&\n    point.y >= rect.y &&\n    point.y <= rect.y + rect.height\n  );\n}\n\nexport function getShapeRect(shape) {\n  const end = shape.path.length - 1;\n  if (shape.type === CIRCLE) {\n    const halfWidth = Math.abs(shape.path[0].x - shape.path[end].x);\n    const halfHeight = Math.abs(shape.path[0].y - shape.path[end].y);\n    return {\n      x: Math.min(shape.path[0].x, shape.path[end].x) - halfWidth,\n      y: Math.min(shape.path[0].y, shape.path[end].y) - halfHeight,\n      width: 2 * halfWidth,\n      height: 2 * halfHeight\n    };\n  } else if (shape.type === PEN) {\n    const minX = Math.min(...shape.path.map(p => p.x));\n    const maxX = Math.max(...shape.path.map(p => p.x));\n    const minY = Math.min(...shape.path.map(p => p.y));\n    const maxY = Math.max(...shape.path.map(p => p.y));\n    return {\n      x: minX,\n      y: minY,\n      width: maxX - minX,\n      height: maxY - minY\n    };\n  } else {\n    return {\n      x: Math.min(shape.path[0].x, shape.path[end].x),\n      y: Math.min(shape.path[0].y, shape.path[end].y),\n      width: Math.abs(shape.path[0].x - shape.path[end].x),\n      height: Math.abs(shape.path[0].y - shape.path[end].y)\n    };\n  }\n}\n","import Immutable from 'immutable';\nimport EventBus from './eventBus';\nimport ToolStore, { POINTER, PEN, LINE, CIRCLE, RECT, ERASER } from './toolStore';\nimport Line from './components/shapes/line';\nimport Pen from './components/shapes/pen';\nimport Rect from './components/shapes/rect';\nimport Circle from './components/shapes/circle';\nimport Eraser from './components/eraser';\nimport { pointInsideRect, getShapeRect } from './utils';\n\nexport const SELECT = 'Select';\nexport const DRAW = 'Draw';\nexport const MOVE = 'Move';\nexport const RESIZE = 'Resize';\n\nconst mapTools = {};\nmapTools[LINE] = Line;\nmapTools[RECT] = Rect;\nmapTools[CIRCLE] = Circle;\nmapTools[PEN] = Pen;\nmapTools[ERASER] = Eraser;\n\nclass Store {\n  constructor() {\n    this.id = 'whiteBoardStore';\n    EventBus.on(EventBus.START_PATH, this.startPath.bind(this));\n    EventBus.on(EventBus.MOVE_PATH, this.movePath.bind(this));\n    EventBus.on(EventBus.END_PATH, this.endPath.bind(this));\n    EventBus.on(EventBus.UNDO, this.undo.bind(this));\n    EventBus.on(EventBus.REDO, this.redo.bind(this));\n    EventBus.on(EventBus.PICK_VERSION, this.pickVersion.bind(this));\n    EventBus.on(EventBus.MOVE, this.move.bind(this));\n\n    this.data = {\n      shapes: Immutable.List.of(),\n      selected: [],\n      mouseTracker: null\n    };\n    this.history = [this.data.shapes];\n    this.historyIndex = -1;\n    this.tool = Pen;\n    this.color = 'black';\n\n    ToolStore.subscribe(() => {\n      const tool = ToolStore.tool;\n      this.toolType = tool;\n      this.tool = mapTools[tool] || null;\n      this.color = ToolStore.color;\n    });\n  }\n  subscribe(cb) {\n    EventBus.on(this.id, cb);\n  }\n  emitChanges() {\n    EventBus.emit(this.id);\n  }\n  startPath(event, position) {\n    this.data.mouseTracker = {\n      class: this.tool,\n      type: this.toolType,\n      path: [position],\n      color: this.color\n    };\n    if (this.toolType === POINTER) {\n      this.selectShape(position);\n    }\n    this.emitChanges();\n  }\n  movePath(event, position) {\n    //console.log('position',position)\n    if (this.data.mouseTracker) {\n      this.data.mouseTracker.path.push(position);\n      this.emitChanges();\n    }\n  }\n  endPath(event, position) {\n    if (this.data.mouseTracker) {\n      this.data.mouseTracker.path.push(position);\n      if (this.toolType === POINTER) {\n        this.addVersion();\n      } else if (this.data.mouseTracker.class) {\n        this.addShapeToCanvas(this.data.mouseTracker);\n      }\n      this.data.mouseTracker = null;\n      this.emitChanges();\n    }\n  }\n  addShapeToCanvas(shape) {\n    this.data.shapes = this.data.shapes.push(shape);\n    this.data.mouseTracker = null;\n    this.addVersion();\n  }\n  selectShape(position) {\n    this.data.shapes = this.data.shapes.map(shape => {\n      if (pointInsideRect(position, getShapeRect(shape))) {\n        return { ...shape, selected: true };\n      } else {\n        return { ...shape, selected: false };\n      }\n    });\n  }\n  addVersion() {\n    this._catHistory();\n    this.history.push(this.data.shapes);\n    this.historyIndex = -1;\n  }\n\n  undo() {\n    if (this.history.length > 0) {\n      if (this.historyIndex === -1) this.historyIndex = this.history.length - 1;\n      this.pickVersion(null, this.historyIndex - 1);\n    }\n  }\n\n  redo() {\n    if (this.history.length > 0) {\n      this.pickVersion(null, this.historyIndex + 1);\n    }\n  }\n\n  _catHistory() {\n    if (this.historyIndex >= 0) {\n      this.history.splice(\n        this.historyIndex + 1,\n        this.history.length - this.historyIndex - 1\n      );\n    }\n  }\n  pickVersion(event, index) {\n    // console.log(index);\n    if (this.history && this.history[index]) {\n      this.historyIndex = index;\n      let shapes = this.history[index];\n      this.data.shapes = shapes;\n      this.emitChanges();\n    }\n  }\n  move(event, { shape, move }) {\n    this.data.shapes = this.data.shapes.map(s => {\n      if (shape === s) {\n        return {\n          ...s,\n          path: s.path.map(({ x, y }) => ({\n            x: x + move.x,\n            y: y + move.y\n          }))\n        };\n      } else {\n        return s;\n      }\n    });\n  }\n}\n\nexport default new Store();\n","import React from 'react';\n\nexport default class Selection extends React.Component {\n  constructor() {\n    super();\n    this.startMove = this.startMove.bind(this);\n    this.endMove = this.endMove.bind(this);\n    this.onMove = this.onMove.bind(this);\n    this.startPoint = null;\n  }\n  startMove(e) {\n    e.preventDefault();\n    this.startPoint = { x: e.clientX, y: e.clientY };\n  }\n  endMove(e) {\n    e.preventDefault();\n    this.startPoint = null;\n  }\n  onMove(e) {\n    if (this.startPoint) {\n      e.preventDefault();\n      const move = {\n        x: e.clientX - this.startPoint.x,\n        y: e.clientY - this.startPoint.y\n      };\n      this.props.move(move);\n      this.startPoint = { x: e.clientX, y: e.clientY };\n    }\n  }\n\n  render() {\n    const { rect } = this.props;\n    return (\n      <rect\n        x={rect.x}\n        y={rect.y}\n        id=\"selection\"\n        width={rect.width}\n        height={rect.height}\n        onMouseUp={this.endMove}\n        onMouseMove={this.onMove}\n        onMouseDown={this.startMove}\n      />\n    );\n  }\n}\n","import React from 'react';\nimport EventBus from '../eventBus';\nimport Store from '../store';\nimport Selection from './selection';\nimport { getShapeRect } from '../utils';\n\nexport default class WhiteBoard extends React.Component {\n  constructor() {\n    super();\n\n    Store.subscribe(() => {\n      this.setState({ data: Store.data });\n    });\n    this.state = { data: Store.data };\n    this.pressed = false;\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.mouseDown.bind(this));\n    document.addEventListener('mousemove', this.mouseMove.bind(this));\n    document.addEventListener('mouseup', this.mouseUp.bind(this));\n    document.addEventListener('keydown', this.keyDown.bind(this));\n    window.addEventListener('resize', this.onResize.bind(this));\n\n    this.onResize();\n    this.setState({ data: Store.data });\n  }\n\n  onResize() {\n    this.rect = this._svg.getBoundingClientRect();\n  }\n\n  mousePos(e) {\n    let round = 2;\n    return {\n      x: round * Math.round(e.clientX / round) - this.rect.left,\n      y: round * Math.round(e.clientY / round) - this.rect.top\n    };\n  }\n\n  _insideRect(rect, point) {\n    return (\n      point.x > rect.left &&\n      point.x < rect.right &&\n      point.y > rect.top &&\n      point.y < rect.bottom\n    );\n  }\n\n  mouseDown(e) {\n    if (this._insideRect(this.rect, { x: e.clientX, y: e.clientY })) {\n      this.pressed = true;\n      EventBus.emit(EventBus.START_PATH, this.mousePos(e));\n    }\n  }\n\n  mouseMove(e) {\n    if (this.pressed) {\n      EventBus.emit(EventBus.MOVE_PATH, this.mousePos(e));\n    }\n  }\n\n  mouseUp(e) {\n    this.pressed = false;\n    EventBus.emit(EventBus.END_PATH, this.mousePos(e));\n  }\n\n  preventContextMenu = event => {\n    event.preventDefault();\n    return false;\n  }\n\n  keyDown(e) {\n    switch (e.keyCode) {\n      case 27: // escape\n        EventBus.emit(EventBus.UNDO);\n        break;\n      case 82: // KeyR\n        EventBus.emit(EventBus.REDO);\n        break;\n        default: // do nothing.\n    }\n  }\n  onMove(shape) {\n    return move => {\n      EventBus.emit(EventBus.MOVE, { shape, move });\n    };\n  }\n\n  render() {\n    const data = this.state.data;\n    let selection = null;\n    const shapes = data.shapes.map((shape, i) => {\n      if (shape.selected) {\n        selection = (\n          <Selection rect={getShapeRect(shape)} move={this.onMove(shape)} />\n        );\n      }\n      return <shape.class key={i} path={shape.path} color={shape.color} />;\n    });\n    let current = null;\n    if (data.mouseTracker && data.mouseTracker.class) {\n      current = (\n        <data.mouseTracker.class\n          color={data.mouseTracker.color}\n          path={data.mouseTracker.path}\n        />\n      );\n    }\n\n    return (\n      <svg\n        id=\"whiteBoard\"\n        width={this.props.width}\n        height={this.props.height}\n        ref={canvas => (this._svg = canvas)}\n        onContextMenu={this.preventContextMenu}\n      >\n        {shapes}\n        {current}\n        {selection}\n      </svg>\n    );\n  }\n}\n","import React from 'react';\nimport EventBus from '../eventBus';\nimport ToolStore from '../toolStore';\n\nexport default class ColorPicker extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      colors: [\n        'red',\n        'orange',\n        'yellow',\n        'green',\n        'blue',\n        'indigo',\n        'violet',\n        'black'\n      ],\n      selectedColorIndex: 7\n    };\n    ToolStore.subscribe(() => {\n      let selectedColor = ToolStore.color;\n      let selectedColorIndex = this.state.colors.indexOf(selectedColor);\n      this.setState({ selectedColorIndex: selectedColorIndex });\n    });\n  }\n  handleClick(index) {\n    return function() {\n      EventBus.emit(EventBus.COLOR_CHANGE, this.state.colors[index]);\n    };\n  }\n\n  render() {\n    let colors = this.state.colors.map((color, i) => {\n      let style = {\n        display: 'flex',\n        backgroundColor: color,\n        width: 20,\n        height: 20,\n        margin: 5\n      };\n      let borderStyle = {\n        display: 'flex',\n        border: this.state.selectedColorIndex === i ? '1px solid' : '',\n        margin: 1\n      };\n\n      return (\n        <div key={i} style={borderStyle}>\n          <div style={style} onClick={this.handleClick(i).bind(this)} />\n        </div>\n      );\n    });\n\n    return <div id=\"colors\"> {colors} </div>;\n  }\n}\n","import React from 'react';\nimport EventBus from '../eventBus';\nimport ToolStore, { POINTER, PEN, LINE, CIRCLE, RECT, ERASER } from '../toolStore';\nimport ColorPicker from './colorPicker';\n\nexport default class Tools extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      tools: [\n        { id: POINTER, label: 'fa-mouse-pointer', type: 'cursor' },\n        { id: LINE, label: 'fa-minus', type: 'line' },\n        { id: RECT, label: 'fa-square-o', type: 'rect' },\n        { id: CIRCLE, label: 'fa-circle-thin', type: 'circle' },\n        { id: PEN, label: 'fa-pencil', type: 'pen', selected: true },\n        { id: ERASER, label: 'fa-eraser', type: 'eraser' }\n      ]\n    };\n    ToolStore.subscribe(() => {\n      const tools = this.state.tools.map(tool => ({\n        ...tool,\n        selected: ToolStore.tool === tool.id\n      }));\n      this.setState({ tools });\n    });\n  }\n  handleClick(index) {\n    return function() {\n      EventBus.emit(EventBus.TOOL_CHANGE, this.state.tools[index].id);\n    };\n  }\n\n  render() {\n    const tools = this.state.tools.map((tool, i) => (\n      <div\n        key={i}\n        onClick={this.handleClick(i).bind(this)}\n        className={tool.selected ? 'selected' : ''}\n      >\n        <i className={tool.label + ' fa'} />\n      </div>\n    ));\n    return (\n      <div id=\"tools\">\n        {tools}\n        <ColorPicker />\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport EventBus from '../eventBus';\nimport Store from '../store';\n\nexport default class History extends React.Component {\n  constructor() {\n    super();\n\n    Store.subscribe(() => {\n      this.setState({\n        history: Store.history,\n        selectedIndex: Store.historyIndex\n      });\n    });\n\n    this.state = {\n      history: [],\n      selectedIndex: -1\n    };\n  }\n\n  handleClick(index) {\n    return function() {\n      EventBus.emit(EventBus.PICK_VERSION, index);\n    };\n  }\n\n  render() {\n    let versions = this.state.history.map((version, i) => (\n      <span\n        key={i}\n        onClick={this.handleClick(i).bind(this)}\n        className={this.state.selectedIndex === i ? 'selected' : ''}\n      />\n    ));\n    return <div id=\"history\"> History: {versions} </div>;\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport WhiteBoard from './components/whiteBoard';\nimport Tools from './components/tools';\nimport History from './components/history';\n\nReactDOM.render(\n  <div id=\"main\">\n    <div id=\"container\">\n      <Tools />\n      <WhiteBoard />\n    </div>\n    <History />\n  </div>,\n  document.getElementById('app')\n);\n"],"sourceRoot":""}